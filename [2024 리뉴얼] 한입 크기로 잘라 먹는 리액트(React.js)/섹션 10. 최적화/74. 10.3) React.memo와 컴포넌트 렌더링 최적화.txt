74. 10.3) React.memoì™€ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ìµœì í™”

React.memo
ì»´í¬ë„ŒíŠ¸ë¥¼ ì¸ìˆ˜ë¡œ ë°›ì•„, ìµœì í™”ëœ ì»´í¬ë„ŒíŠ¸ë¡œ ë§Œë“¤ì–´ ë°˜í™˜

const MemoizedComponent = memo(Component)
ë°˜í™˜ê°’ : ìµœì í™” ëœ ì»´í¬ë„ŒíŠ¸, Propsë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë©”ëª¨ì´ì œì´ì…˜ ë¨

App.jsx
TodoItem.jsx
Header.jsx
---

App.jsx

import './App.css'
import { useState, useRef, useReducer } from 'react'
import Header from './components/Header'
import Editor from './components/Editor'
import List from './components/List'
// import Exam from './components/Exam'

const mockData = [
  {
    id : 0,
    isDone : false,
    content : "React ê³µë¶€í•˜ê¸°",
    date : new Date().getTime(),
  },
  {
    id : 1,
    isDone : false,
    content : "ì˜í™” ê°ìƒí•˜ê¸°",
    date : new Date().getTime(),
  },
  {
    id : 2,
    isDone : false,
    content : "ë³¼ë§",
    date : new Date().getTime(),
  },
];

function reducer(state, action) {
  switch(action.type) {
    case 'CREATE' : return [action.data, ...state]
    case 'UPDATE' : return state.map((item) => item.id === action.targetId? {...item, isDone: !item.isDone} : item);
    case 'DELETE' : return state.filter((item)=>item.id !== action.targetId)
    default : return state;
  }
}

function App() {

  // const [todos, setTodos] = useState(mockData);
  
  const [todos, dispatch] = useReducer(reducer, mockData);
  const idRef = useRef(3);

  const onCreate = (content) => {
    // const newTodo = {
      // id : idRef.current++,
      // isDone : false,
      // content : content,
      // date : new Date().getTime(),

      dispatch({
        type : "CREATE",
        data : {
          id : idRef.current++,
          isDone : false,
          content : content,
          date : new Date().getTime(),
        },
      });
    };

    // todosë°°ì—´ ì¶”ê°€
    // ì•„ë˜ì™€ ê°™ì´ í•˜ë©´ ì ˆëŒ€ ì•ˆë¨... stateì˜ ê°’ì€ ìƒíƒœë³€í™”ì˜ ê°’ì„ ì ìš©ì‹œì¼œì¤˜ì•¼í•¨.
    // todos.push(newTodo)

  //   setTodos([newTodo, ...todos]);
  // };

  // ì•„ì´í…œ ìˆ˜ì •
  const onUpdate = (targetId) => {
    // todos Stateì˜ ê°’ë“¤ ì¤‘ì—
    // targetIdì™€ ì¼ì¹˜í•˜ëŠ” idë¥¼ ê°–ëŠ” íˆ¬ë‘ ì•„ì´í…œì˜ isDone ë³€ê²½

    // ì¸ìˆ˜ : todos ë°°ì—´ì—ì„œ targetIdì™€ ì‰ã„¹ì¹˜í•˜ëŠ” idë¥¼ ê°–ëŠ” ìš”ì†Œì˜ ë°ì´í„°ë§Œ ë”± ë°”ê¾¼ ìƒˆë¡œìš´ ë°°ì—´
    // todoì˜ idê°€ í˜„ì¬ íƒ€ê²Ÿ idì™€ ê°™ë‹¤ë©´ ê·¸ë•Œì—ëŠ” ê¸°ì¡´ì˜ íˆ¬ë‘ ê°ì²´ì— isdoneì˜ í”„ë¡œí¼í‹°ë§Œ ë³€ê²½ì„ í•˜ê³ 
    // ê°™ì§€ ì•Šì„ ê²½ìš° ê¸°ì¡´ íˆ¬ë‘ì˜ ê°’ì„ ë¦¬í„´í•´ì£¼ë©´ ëœë‹¤!
    // setTodos(todos.map((todo) =>
    //   todo.id === targetId
    //   ? { ...todo, isDone : !todo.isDone}
    //   : todo)
    // );

    dispatch({
      type: "UPDATE",
      targetId: targetId,
    });
  };

  // ì•„ì´í…œ ì‚­ì œ
  const onDelete = (targetId) => {
    // // ì¸ìˆ˜ : todos ë°°ì—´ì—ì„œ targetIdì™€ ì¼ì¹˜í•˜ëŠ” idë¥¼ ê°–ëŠ” ìš”ì†Œë§Œ ì‚­ì œí•œ ìƒˆë¡œìš´ ë°°ì—´
    // setTodos(todos.filter((todo)=>todo.id !== targetId));

    dispatch({
      type : "DELETE",
      targetId : targetId,
    })
  };

  return (
   <div className="App">
      {/* <Exam /> */}
      <Header />
      <Editor onCreate={onCreate} />
      <List
        todos={todos}
        onUpdate={onUpdate}
        onDelete={onDelete} />
    </div>
  )
}

export default App;

---
TodoItem.jsx

import "./TodoItem.css";
import { memo } from 'react';

const TodoItem = ({
    id,
    isDone,
    content,
    date,
    onUpdate,
    onDelete
}) => {

    const onChangeCheckbox = () => {
        onUpdate(id);
    };

    const onClickDeleteButton = () => {
        onDelete(id);
    };

    return (
        <div className="TodoItem">
            <input
                // inputìš”ì†Œì´ê¸°ì— onChangeë¡œ ì„ ì–¸ì„ í•˜ì˜€ìŒ.
                onChange={onChangeCheckbox}
                readOnly
                checked={isDone}
                type="checkbox" />
            <div className="content">{content}</div>
            <div className="date">
                {new Date(date).toLocaleDateString()}
            </div>
            <button onClick={onClickDeleteButton}>ì‚­ì œ</button>
        </div>
    );
};

// export default TodoItem;

// ê³ ì°¨ ì»´í¬ë„ŒíŠ¸ (HOC)
export default memo(TodoItem, (prevProps, nextProps)=>{
    // ë°˜í™˜ê°’ì— ë”°ë¼, Propsê°€ ë°”ë€Œì—ˆëŠ”ì§€ ì•ˆë°”ë€Œì—ˆëŠ”ì§€ íŒë‹¨
    // True -> Props ë°”ë€Œì§€ ì•ŠìŒ -> ë¦¬ë Œë”ë§ X
    // False -> Props ë°”ë€œ -> ë¦¬ë Œë”ë§ O

    if(prevProps.id !== nextProps.id) return false;
    if(prevProps.isDone !== nextProps.isDone) return false;
    if(prevProps.content !== nextProps.content) return false;
    if(prevProps.date !== nextProps.date) return false;

    return true;
});

---
Header.jsx

import "./Header.css";
import { memo } from "react";

const Header = () => {
    return (
        <div className="Header">
            <h3>ì˜¤ëŠ˜ì€ ğŸš—</h3>
            <h1>{new Date().toDateString()}</h1>
        </div>
    );
};

// export default Header;
export default memo(Header);

